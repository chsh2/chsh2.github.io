<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Sketch Cleanup#NijiGPen&rsquo;s line operators provide functionality that helps turn raw sketches into final line art. A raw sketch usually contains repeated strokes, line splits, and line gaps that require a lot of manual effort to clean up. The Line Fit operators can speed up this process by merging multiple strokes into a single, smooth stroke.
Fit Sketch to Single Line#The major way of using this function is from the sidebar panel in the Edit mode.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Sketch Cleanup" />
<meta property="og:description" content="Sketch Cleanup#NijiGPen&rsquo;s line operators provide functionality that helps turn raw sketches into final line art. A raw sketch usually contains repeated strokes, line splits, and line gaps that require a lot of manual effort to clean up. The Line Fit operators can speed up this process by merging multiple strokes into a single, smooth stroke.
Fit Sketch to Single Line#The major way of using this function is from the sidebar panel in the Edit mode." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chsh2.github.io/nijigp/docs/functionality/line/fit/" /><meta property="article:section" content="docs" />


<title>Sketch Cleanup | NijiGPen Documentation</title>
<link rel="manifest" href="/nijigp/manifest.json">
<link rel="icon" href="/nijigp/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/nijigp/book.min.d984b6ffea0097d4b26e4daa87fa4167406fdf2cd1fda9eeddadf6f3c5823974.css" integrity="sha256-2YS2/&#43;oAl9Sybk2qh/pBZ0Bv3yzR/anu3a3288WCOXQ=" crossorigin="anonymous">
  <script defer src="/nijigp/flexsearch.min.js"></script>
  <script defer src="/nijigp/en.search.min.8cc5c313498b79dd0d8e2d706127b129f5cee24d5b2d93a60f9e79d2a62f2499.js" integrity="sha256-jMXDE0mLed0Nji1wYSexKfXO4k1bLZOmD5550qYvJJk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/nijigp/"><span>NijiGPen Documentation</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Get Started</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/get_started/installation/" class="">Installation</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/get_started/installation/dependency/" class="">Python Packages</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/get_started/basic_usage/" class="">Basic Usage</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Functionality</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <span>- Polygons -</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/polygon/bool/" class="">Boolean</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/polygon/offset/" class="">Offset</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/polygon/sweep/" class="">Sweep</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/polygon/holdout/" class="">Hole Holdout</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>- Lines -</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/line/fit/" class="active">Sketch Cleanup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/line/tuning/" class="">Stroke Tuning</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/line/smart_fill/" class="">Smart Fill</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>- Meshes -</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/mesh/generation/" class="">Mesh Generation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/mesh/management/" class="">Mesh Management</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>- Animations -</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/animation/frame_animation/" class="">Frame Animations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/animation/rigging/" class="">Rigging Utilities</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>- Import/Export -</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/io/brushes/" class="">Brush Import</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/io/clipboard/" class="">Clipboard Utilities</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/io/vectorizing_images/" class="">Vectorizing Images</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/functionality/io/psd_render/" class="">PSD Render</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Tips</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/tips/scene_setup/" class="">Scene Setup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/nijigp/docs/tips/limitations/" class="">Limitations</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Developer Notes (TODO)</span>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/nijigp/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Sketch Cleanup</strong>

  <label for="toc-control">
    
    <img src="/nijigp/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#fit-sketch-to-single-line">Fit Sketch to Single Line</a>
      <ul>
        <li><a href="#inherit-point-attributes">Inherit Point Attributes</a></li>
      </ul>
    </li>
    <li><a href="#fit-sketch-to-multiple-lines">Fit Sketch to Multiple Lines</a>
      <ul>
        <li><a href="#cluster-select">Cluster Select</a></li>
      </ul>
    </li>
    <li><a href="#fit-sketch-in-draw-mode">Fit Sketch in Draw Mode</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="sketch-cleanup">
  Sketch Cleanup
  <a class="anchor" href="#sketch-cleanup">#</a>
</h1>
<p>NijiGPen&rsquo;s line operators provide functionality that helps turn raw sketches into final line art. A raw sketch usually contains repeated strokes, line splits, and line gaps that require a lot of manual effort to clean up. The Line Fit operators can speed up this process by merging multiple strokes into a single, smooth stroke.</p>
<p><img src="../fit_single.png" alt="" /></p>
<h2 id="fit-sketch-to-single-line">
  Fit Sketch to Single Line
  <a class="anchor" href="#fit-sketch-to-single-line">#</a>
</h2>
<div class="book-columns flex flex-wrap">

  <div class="flex-even markdown-inner">
    The major way of using this function is from the sidebar panel in the <code>Edit</code> mode. The <code>Single-Line</code> button turns all selected strokes in the active frame to one new stroke.
  </div>

  <div class="flex-even markdown-inner">
    <img src="../fit_panel.png" alt="" />
  </div>

</div>

<p>The process of merging multiple strokes is automatic. However, in order to get a smooth output, there are two options to configure:</p>
<ul>
<li><code>Line Spacing</code> determines a range, within which the lines drawn in parallel will be smoothed.</li>
<li><code>Smoothness</code> uses either Bézier or resampling method to make the output stroke smoother.</li>
</ul>
<p>Basically, they control the smooth level in two orthogonal directions, which is indicated in the following figure:</p>
<p><img src="../fit_params.png" alt="" /></p>
<h3 id="inherit-point-attributes">
  Inherit Point Attributes
  <a class="anchor" href="#inherit-point-attributes">#</a>
</h3>
<p>By default, the radius of the output stroke points is determined by whether the sketches are densely or sparsely drawn. The point strength/opacity will be set to 1. However, the user can also choose to use the strength/radius value from the input strokes.</p>
<p>Vertex color and line UV can also be inherited from input to output.</p>
<h2 id="fit-sketch-to-multiple-lines">
  Fit Sketch to Multiple Lines
  <a class="anchor" href="#fit-sketch-to-multiple-lines">#</a>
</h2>
<p>Sometimes the sketch is complex, and the user may want to convert it to multiple lines instead of a single one. The <code>Multi-Line</code> button will attempt to categorize the input strokes into clusters, and perform the line fit for each cluster separately.</p>
<p>The algorithm measures the distance between each pair of input strokes in a pointwise manner to determine which strokes belong to the same cluster.</p>
<p><img src="../fit_multi.png" alt="" /></p>
<p>The number of clusters is important, as shown in the figure above. There are several options to tune this value:</p>
<ul>
<li><strong>By Absolute Distance</strong>: Specifying a length as the maximum distance between strokes in the same cluster.</li>
<li><strong>By Relative Distance</strong>: Using a ratio of the stroke length as the maximum distance.</li>
<li><strong>By Number</strong>: Setting the maximum amount of clusters.</li>
</ul>
<h3 id="cluster-select">
  Cluster Select
  <a class="anchor" href="#cluster-select">#</a>
</h3>
<p>The <code>Cluster Select</code> button applies the same criterion to find similar strokes (i.e., having a small pointwise distance) with the selected ones. However, it enlarges the selection instead of fitting the strokes. This operator can be used to select strokes which may belong to the same part of the drawing.</p>
<h2 id="fit-sketch-in-draw-mode">
  Fit Sketch in Draw Mode
  <a class="anchor" href="#fit-sketch-in-draw-mode">#</a>
</h2>
<p><img src="../fit_draw.png" alt="" /></p>
<p>The Line Fit function can also be used in the <code>Draw</code> mode. In this mode, the user should assign the layer containing the sketch as the <code>Reference Layer</code>, and then draw the line art in a new layer. The operator will refine and smooth the <strong>latest drawn</strong> stroke according to the sketch.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#fit-sketch-to-single-line">Fit Sketch to Single Line</a>
      <ul>
        <li><a href="#inherit-point-attributes">Inherit Point Attributes</a></li>
      </ul>
    </li>
    <li><a href="#fit-sketch-to-multiple-lines">Fit Sketch to Multiple Lines</a>
      <ul>
        <li><a href="#cluster-select">Cluster Select</a></li>
      </ul>
    </li>
    <li><a href="#fit-sketch-in-draw-mode">Fit Sketch in Draw Mode</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












